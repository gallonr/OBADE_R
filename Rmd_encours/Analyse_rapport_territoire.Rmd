---
title: "ESTAMP : Synthèse des résultats des données d'usage de la zone intertidale"
author: "Etienne Patin"
date: "21/04/2020"
header-includes: 
    - \usepackage{draftwatermark}
output:
  pdf_document:
    df_print: kable
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_depth: 5
lot: yes
lof: yes
subtitle: "Echelle de l'Observatoire PAP"
lang: FR-fr
toc-title: Sommaire
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
require(ggplot2)
require(ggmap)
require(tidyverse)
require(tinytex)
require(ggmap)
```

\SetWatermarkText{DRAFT} 

```{r importation_jdd, message=FALSE, warning=FALSE, include=FALSE}
source("internal_function.R")
load("./export/table/enquetePeche.Rdata")

enquetePeche.resum <- descript.database(enquetePeche)
enquetePeche.resum <- enquetePeche.resum %>% mutate(pourc_NA=(Nombre_NA/nrow(enquetePeche))*100)

selection_territoire <- c("Golfe Normand Breton","Estuaires Picards et Mer d'Opale",
                          "Côtes d'Armor", "Côtes du Calvados", "Baie de Morlaix","Côte des Légendes","Rade de Brest") 

ifelse(length(selection_territoire) > 0,
       enquetePecheSel <- enquetePeche %>% filter(territoire %in% selection_territoire),
       enquetePecheSel <- enquetePeche)



```

\pagebreak

Ce document a pour but de confronter l’analyse des comptages et des enquêtes de la pèche à pied aux données de la base de données ESTAMP. Plusieurs rapports furent analysés pour cerner les éléments essentiels à la constitution d’un rapport. L’étude de la base donnée ESTAMP va permettre d’informer l’état des données pour chaque élément constitutif des rapports.
  
Le plan est tiré de la Trame Rapport de diagnostic de la pêche de loisir sur le territoire 
  
#  Evaluation quantitative de l’activité de pêche à pied – Les comptages 
  
L’étude de la base de données ESTAMP ne comprends pas les comptages, l’analyse de cette partie n’est pas effectuée.
  
#  Evaluation qualitative de l’activité de pêche à pied – Les enquêtes 
  
##  Une méthodologie issue du projet LIFE « Pêche à pied de loisir » 
  
###  Le questionnaire 
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Cette partie permet de connaitre le questionnaire utilisé pour les enquêtes. La version du questionnaire est citée et les changements, suppression de questions sont expliqués quand c’est le cas.  
Les données sont bancarisées dans le jeu de données « ficheterrain », dans la variable « version protocole » et  « type protocole ».  
Etat des données :  

* version protocole: 
  - Nombre d’observation : `r length(na.omit(enquetePecheSel$'version protocole'))` 
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'version protocole'))/length(enquetePecheSel$'version protocole'))*100,2)`%
  - Commentaire : très grande diversité de modalité signe d’une utilisation de plusieurs protocoles. Cependant il existe plusieurs modalités pour un type de protocole (ex : Qlife2 ; QLife2) 
* type protocole:
  - Nombre d'observations :`r length(na.omit(enquetePecheSel$'type protocole'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'type protocole'))/length(enquetePecheSel$'version protocole'))*100,2)`%
  
```{r liste_protocoles}

versionProtocole.count <- enquetePecheSel %>% count(`version protocole`)
versionProtocole.count <- drop_na(versionProtocole.count)
knitr::kable(versionProtocole.count, caption = "Nombre d'observation pour chaque protocole dans la base de données ESTAMP")
```


```{r type_protocole}

typeProtocole.count <- enquetePecheSel %>% count(`type protocole`)
typeProtocole.count <- drop_na(typeProtocole.count)
knitr::kable(typeProtocole.count, caption = "Nombre d'observation pour chaque type de protocole dans la base données ESTAMP")
```


###  Objectifs et calendrier 
  
Rapports : [2] ; [3] ; [4] ; [5] ; [6]	
Les actions de l’organisme pour mener ces enquêtes sont décrites dans cette partie. Elle n’a pas d’interaction avec la Base de données ESTAMP.
  
## Résultats d’enquêtes 	  
  
###  Accueil réservé aux enquêteurs 
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Cet élément est soit une sous partie ou est simplement inséré dans la conclusion de « résultats d’enquêtes ».  
Les données sont bancarisées dans le jeu de données « enquête_detail », dans la variable « Accueil ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$Accueil))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Accueil))/length(enquetePecheSel$Accueil))*100,2)`%    
  
```{r accueil, fig.cap="Différents types d'accueil", fig.asp=0.8, fig.align='center'}

accueil.count <- enquetePecheSel %>% count(Accueil)
accueil.count$Accueil <- factor(accueil.count$Accueil, levels = c("Bon", "Moyen", "Mauvais", "Refus", "NA"), ordered = TRUE)
accueil.count <- drop_na(accueil.count)
ggplot(accueil.count, aes(x = Accueil, y = n)) +
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme
  
```

###	 Part des pêcheurs sensibilisés 
  
Rapports : [3]  
Les données sont bancarisées dans le jeu de données « enquête_preparation_peche », dans la variable « Pecheur Sensibilisé ».  
Etat des données : 

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Pecheur Sensibilisé'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Pecheur Sensibilisé'))/length(enquetePecheSel$'Pecheur Sensibilisé'))*100,2)`%   

```{r pêcheurs sensibilisés, fig.cap="Part des pêcheurs sensibilisés"}

pecheursensi.count <- enquetePecheSel %>% count(`Pecheur Sensibilisé`)
pecheursensi.count <- drop_na(pecheursensi.count)
ggplot(pecheursensi.count, aes(x = `Pecheur Sensibilisé`, y = n))+
  geom_bar(stat = "identity")+
  obade_theme+
  ylab("Nombre de pécheur")
```


###  Profils des pêcheurs enquêtés  
  
####	Sexe ratio 
   
Rapports : [1] ; [2] ; [3] ; [4] ; [5]  

Les résultats sont des pourcentages avec des modalités Femme ou Homme. Une autre peut aussi être rencontrée, il s’agit de la modalité « enfant ».  
Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « Sexe pêcheurs » mais aussi dans la variable « Sexe – autre membre ».  
Etat des données :  

* Sexe pêcheurs  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Sexe - Pécheur'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Sexe - Pécheur'))/length(enquetePecheSel$'Sexe - Pécheur'))*100,2)`%  
* Sexe – autre membre  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Sexe - Autre membre'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Sexe - Autre membre'))/length(enquetePecheSel$'Sexe - Autre membre'))*100,2)`%  

```{r Sexe_Pêcheur, fig.cap= "Répartition des pêcheurs selon leur sexe"}
pecheursexe.count <- tibble(sexe=c(enquetePecheSel$'Sexe - Pécheur',enquetePecheSel$'Sexe - Autre membre'))
pecheursexe.count <- pecheursexe.count %>% count(sexe)
pecheursexe.count <- drop_na(pecheursexe.count)
ggplot(pecheursexe.count, aes(x = sexe, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheur")+
  xlab("Sexe Pêcheur")+
  obade_theme

```
  

  
####	Constitution du groupe 
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5]  
Les données sont bancarisées dans le jeu de données « préparation_pêche », dans la variable « Constitution Groupe ».   
L’analyse reprend les modalités de la base de données : 

* En famille
* Pêcheur seul
* En couple
* En groupe d’amis

Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Constitution Groupe'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Constitution Groupe'))/length(enquetePecheSel$'Constitution Groupe'))*100,2)`%   
  
```{r groupe, fig.cap="Constitution des groupes de pêcheur"}

groupe.count <- enquetePecheSel %>% count(`Constitution Groupe`)
groupe.count <- drop_na(groupe.count)
ggplot(groupe.count, aes(x = `Constitution Groupe`, y = n))+
  geom_bar(stat = "identity")+
  obade_theme+
  ylab("Nomnre de pêcheurs")

```
  
  
#### Catégories socio-professionnelles des pêcheurs rencontrés
  
Rapports : [5]  
Les données sont bancarisées dans le jeu de données « enquête_detail », dans la variable « CSP – Pécheur ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'CSP - Pécheur'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'CSP - Pécheur'))/length(enquetePecheSel$'CSP - Pécheur'))*100,2)`% 
* Commentaire : forte diversité de modalité  

```{r CSP_tableau, fig.cap="Tableau des différentes catégories socio-professionnelles des pêcheurs"}

CSP.count <- enquetePecheSel%>% count(`CSP - Pécheur`)
CSP.count <- drop_na(CSP.count)
knitr::kable(CSP.count, caption = "Nombre de Catégories socio-professionnelles des pêcheurs rencontrés")
```

```{r CSP_graph, fig.height=8,fig.width=5, fig.cap="Graphique des différentes catégories socio-profesionnelles des pêcheurs"}

ggplot(CSP.count, aes(x= `CSP - Pécheur`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
 
```


####	Classe d’âge/expérience
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Les résultats sont traités de différentes manières.  
Elles sont soit réparties en plusieurs classes d’âge (soit par tranche de 15 ans, soit par tranche de 10 ans…).   Certains rapports n’utilisent que la moyenne comme résultats.  
Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « année naissance – Pêcheur » et dans la variable « année naissance – Autre membre ».  
Etat des données :  

* Année naissance – Pêcheur   
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Annee Naissance - Pécheur'))`
  + Taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'Annee Naissance - Pécheur'))/length(enquetePecheSel$'Annee Naissance - Pécheur'))*100,2)`%
  + Moyenne : `r round(mean(enquetePecheSel$'Annee Naissance - Pécheur', na.rm= TRUE),2)`
  + Minimum : `r min(enquetePecheSel$'Annee Naissance - Pécheur', na.rm= TRUE)`
  + Maximum : `r max(enquetePecheSel$'Annee Naissance - Pécheur', na.rm= TRUE)`
* Année naissance – Autre membre   
  + Nombre d’observations :  `r length(na.omit(enquetePecheSel$'Annee Naissance - Autre membre'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Annee Naissance - Autre membre'))/length(enquetePecheSel$'Annee Naissance - Autre membre'))*100,2)`%
  + Moyenne : `r round(mean(enquetePecheSel$'Annee Naissance - Autre membre', na.rm= TRUE),2)`
  + Minimum : `r min(enquetePecheSel$'Annee Naissance - Autre membre', na.rm= TRUE)`
  + Maximum : `r max(enquetePecheSel$'Annee Naissance - Autre membre', na.rm= TRUE)`
  



```{r age, fig.cap="Graphique représentant la diversité d'âge des pêcheurs"}
anneeNaissance <- tibble(annee=c(enquetePecheSel$`Annee Naissance - Pécheur`,enquetePecheSel$`Annee Naissance - Autre membre`),
                         sexe=c(enquetePecheSel$'Sexe - Pécheur',enquetePecheSel$'Sexe - Autre membre'))

anneeNaissance <- anneeNaissance %>% mutate(age=as.numeric(format(Sys.Date(),"%Y"))-annee) %>% 
  mutate(agecut=cut(age,breaks = seq(0, 100, 5), right = FALSE))

anneeNaissance  <- drop_na(anneeNaissance)


agePecheur <- anneeNaissance %>% select(c(`sexe`,`agecut`)) %>%  group_by(`sexe`,`agecut`) %>% rename(age=agecut)

ggplot(agePecheur,aes(x=age))+geom_histogram(stat = "count")+
  geom_freqpoly(stat="count")+
  ylab("Effectifs")+xlab("Age")+
  theme_bw()+obade_theme+coord_flip()+facet_grid(.~sexe)
```


####	Origine géographique
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête détails », il y a plusieurs possibilités pour le choix de variable :  

* « Commune résidence »
* « Départements »
* « Pays »

Etat des données : 

* Commune résidence :  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Commune résidence'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Commune résidence'))/length(enquetePecheSel$'Commune résidence'))*100,2)`%
* Départements   
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$Département))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Département))/length(enquetePecheSel$Département))*100,2)`%
* Pays  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$Pays))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Pays))/length(enquetePecheSel$Pays))*100,2)`%



```{r départements, fig.cap="Tableau listant les différents départements d'origine des pêcheurs"}

departement.count <- enquetePecheSel %>% count(`Département`)
departement.count<- drop_na(departement.count)
knitr::kable(departement.count, caption = "Liste des départemnts cités")
```

```{r commune_map, fig.cap="Distribution des pêcheurs dans l'Hexagone", fig.height=10, fig.width=13, message=FALSE, warning=FALSE}

communeFrance <- read_delim("data/commune_France/villes_france.csv",delim=";")

enquetePecheSel.commune <- enquetePecheSel %>% select(`Commune résidence`) %>% rename(commune=`Commune résidence`)

enquetePecheSel.commune$commune <- str_replace_all(enquetePecheSel.commune$commune, pattern="ST ", repl="SAINT ")
enquetePecheSel.commune$commune <- str_replace_all(enquetePecheSel.commune$commune, pattern="STE ", repl="SAINTE ")
enquetePecheSel.commune$commune <- str_to_lower(enquetePecheSel.commune$commune)
enquetePecheSel.commune <- inner_join(enquetePecheSel.commune,communeFrance,by="commune")

enquetePecheSel.commune <- enquetePecheSel.commune %>% filter(latitude>=41.15 & latitude<=51, longitude>=-7.8 & longitude <=10.62)




map <- get_map(c(-8,41,11,51),maptype = "roadmap")
ggmap(map,darken = .6,base_layer =ggplot(data = enquetePecheSel.commune,aes(longitude,latitude)))+
  stat_density_2d(aes(fill = ..level..), geom = "polygon", alpha = .3, color = NA) +
  scale_fill_gradient2("Nombre de\npêcheur", low = "white", mid = "yellow", high = "red", midpoint = 0.05)+
  theme(legend.position = "none")+xlab("Longitude")+ylab("Latitude")

```

####	Pour les non-résidents de cette partie du littoral
  
##### Type de séjour et type d’hébergement pour les non-résidents
  
Rapports : [3]  
Les données sont bancarisées dans le jeu de données « enquête détails », dans la variable « Hébergement ».  
Etat des données :

+ Nombre d’observations : `r length(na.omit(enquetePecheSel$Hebergement))`
+ Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Hebergement))/length(enquetePecheSel$Hebergement))*100,2)`%

```{r hebergement, fig.cap="Graphique illustrant les différents types d'hébergements pour les pêcheurs non-résidents"}

hebergement.count <- enquetePecheSel %>% count(Hebergement)
hebergement.count <- drop_na(hebergement.count)
ggplot(hebergement.count, aes(x = Hebergement, y = n))+
  geom_bar(stat = "identity")+
  obade_theme+
  ylab("Nombre de pécheur")+
  coord_flip()
```

  
##### Fréquentation du littoral
  
Rapports : [3]  
Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « Durée séjour ».
Etat des données :  

+ Nombre d’observations : `r length(na.omit(enquetePecheSel$'Durée séjour'))`
+ Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Durée séjour'))/length(enquetePecheSel$'Durée séjour'))*100,2)`%
+ Moyenne : `r round(mean(enquetePecheSel$'Durée séjour', na.rm=TRUE),2)`
+ Minimum : `r min(enquetePecheSel$'Durée séjour', na.rm=TRUE)`
+ Maximum : `r max(enquetePecheSel$'Durée séjour', na.rm=TRUE)`



```{r frequentation_littoral, fig.cap="Graphique de la durée de séjour sur le littoral"}

ggplot(enquetePecheSel, aes(x = `Durée séjour`))+
  geom_histogram()+
  ylab("Nombre d'observation")+
  scale_x_continuous(breaks=seq(0,max(na.omit(enquetePecheSel$`Durée séjour`)),20))+
  obade_theme
 
```


##### Influence de la pratique de pêche à pied sur choix du site et des dates de séjour
  
Rapports : [3] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « influence destination ».  
Etat des données :  

+ Nombre d’observations : `r length(na.omit(enquetePecheSel$'Influence Destination'))`
+ Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Influence Destination'))/length(enquetePecheSel$'Influence Destination'))*100,2)`%

```{r influence, fig.cap="Graphique illustrant si la pratique de pêche à pied a une influence sur le choix de destination ou non"}

influence.count <- enquetePecheSel %>% count(`Influence Destination`)
influence.count <- drop_na(influence.count)
ggplot(influence.count, aes(x = `Influence Destination`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de Pécheur")+
  obade_theme
```

##### Premier Séjour 
  
Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « Premier Séjour ».  
Etat des données :  

* Nombre d'observations :`r length(na.omit(enquetePecheSel$'Premier Séjour'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Premier Séjour'))/length(enquetePecheSel$'Premier Séjour'))*100,2)`%

```{r premier_séjour}

premiersejour.count <- enquetePecheSel %>% count(`Premier Séjour`)
premiersejour.count <- drop_na(premiersejour.count)

ggplot(premiersejour.count, aes(x = `Premier Séjour`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme

```
##### Influence Date

Les données sont bancarisées dans le jeu de données « enquête_details », dans la variable « Influence Date ».  
Etat des données :  

* Nombre d'observations : `r length(na.omit(enquetePecheSel$'Influence Date'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Influence Date'))/length(enquetePecheSel$'Influence Date'))*100,2)`%

```{r influence_date}

infludate.count <- enquetePecheSel %>% count(`Influence Date`)
infludate.count <- drop_na(infludate.count)

ggplot(infludate.count, aes(x = `Influence Date`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme
```

  
#### Connaissance du site  

Rapports : [6]  
Il n’y a pas de données sur ESTAMP qui puissent répondre à cette   
  
###	Habitudes et pratiques de pêche (espèces pêchées et engins utilisés)
  
####	Milieux de pêche prospectés
  
Rapports : [1] ; [3] ; [5]  
Cet élément est rempli par les observateurs locaux des enquêtes, ils se basent essentiellement sur leur connaissance du terrain. Mais des données sont disponible sur ESTAMP.  
Les données sont bancarisées dans le jeu de données « enquête_pratique-peche », dans la variable « Milieu(x) ».  

Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Milieu(x)'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Milieu(x)'))/length(enquetePecheSel$'Milieu(x)'))*100,2)`%
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  

```{r milieux, fig.cap="Graphique illustrant le nombre de pêcheur par milieu"}
milieux.count <- enquetePecheSel %>% separate_rows(`Milieu(x)`,sep="\\|") 

milieux.count$`Milieu(x)` <- str_trim(milieux.count$`Milieu(x)`,side=c("both"))

milieux.count <- milieux.count %>% count(`Milieu(x)`)

milieux.count <- drop_na(milieux.count)

knitr::kable(milieux.count, caption = "Différents milieux fréquentés par les pêcheurs à pied")

ggplot(milieux.count, aes(x= `Milieu(x)`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pécheurs")+
  xlab("Milieux prospectés")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
```



  
####	Espèces ciblées + outils utilisés
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5]  
Certains rapports veulent le nombre d’espèces recherchés par pécheur.   
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Espèces » pour les espèces ciblées, dans la variable « Outils ou technique » pour les outils utilisés.  

Etat des données :  

* Espéces  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$Espéces))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Espéces))/length(enquetePecheSel$Espéces))*100,2)`%
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.
* Outils ou technique  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Outils ou techniques'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Outils ou techniques'))/length(enquetePecheSel$'Outils ou techniques'))*100,2)`%
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  

  
```{r especes, eval=FALSE, include=FALSE, fig.cap="Tableau listant toutes les espèces ciblées "}


espece.count<- enquetePecheSel %>% separate_rows('Espéces',sep="\\|") 
espece.count$espece <- str_trim(espece.count$'Espéces',side=c("both"))
espece.count <- espece.count %>% count(`Espéces`)
espece.count <- drop_na(espece.count)
knitr::kable(espece.count , caption = "Liste des espèces ciblés par les pêcheurs")

```
  
```{r outil_utilisé, include=FALSE, eval=FALSE}


outilut.count<- enquetePecheSel %>% separate_rows('Outils ou techniques',sep="\\|") 
outilut.count$`Outils ou techniques` <- str_trim(outilut.count$'Outils ou techniques',side=c("both"))
outilut.count <- espece.count %>% count(`Outils ou techniques`)
outilut.count <- drop_na(outilut.count)
knitr::kable(espece.count , caption = "Liste des espèces ciblés par les pêcheurs")

```

####	Expérience de pêche
  
Rapports : [2] ; [3]  
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Année Premiere Peche ».  

Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Annee Premiere Peche'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Annee Premiere Peche'))/length(enquetePecheSel$'Annee Premiere Peche'))*100,2)`%
* Moyenne : `r round(mean(enquetePecheSel$'Annee Premiere Peche', na.rm= TRUE),2)`
* Minimum : `r min(enquetePecheSel$'Annee Premiere Peche', na.rm=TRUE)` 
* Maximum : `r max(enquetePecheSel$'Annee Premiere Peche', na.rm=TRUE)`

```{r experience_peche, fig.cap="Nombre de pêcheur par année d'expérience"}
exppeche.count <- enquetePecheSel %>% count(`Annee Premiere Peche`)

exppeche.count <- exppeche.count %>% rename(annee = `Annee Premiere Peche`)


exppeche.count <- exppeche.count %>% mutate(anciennete =as.numeric(format(Sys.Date(),"%Y"))- annee) %>% 
  mutate(expcut=cut(anciennete,breaks = seq(0, 100, 5), right = FALSE))


exppeche.count <- drop_na(exppeche.count)
ggplot(exppeche.count, aes(x = expcut, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheur")+
  obade_theme+
  coord_flip()+
  xlab("Année d'expérience")
 
```


####	Motivation du pécheur
  
Rapports : [5]  
Les données sont bancarisées dans le jeu « enquête_pratique_peche », dans la variable « Motivation(s) ». 

Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Motivation(s)'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Motivation(s)'))/length(enquetePecheSel$'Motivation(s)'))*100,2)`%
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  

```{r motivations_pecheur, fig.cap="Nombre de pêcheurs par motivations invoquées pour la pratique de pêche à pied"}

motiv.count<- enquetePecheSel %>% separate_rows('Motivation(s)',sep="\\|") 
motiv.count$`Motivation(s)` <- str_trim(motiv.count$`Motivation(s)`,side=c("both"))
motiv.count <- motiv.count %>% count(`Motivation(s)`)
motiv.count <- drop_na(motiv.count)
knitr::kable(motiv.count , caption = "Motivations évoquées par les pêcheurs pour la pratique de la pêche à pied")


ggplot(motiv.count, aes(x = `Motivation(s)`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
  
```



####	Autres pratiques de pêche
  
Rapports : [2] ; [3] ; [5]  
Les données sont bancarisées dans le jeu de données « enquête_pratiques_peche », dans la variable « Autres types de pêche ».  

Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Autres types de peche'))`
* Taux de remplissage :`r round((length(na.omit(enquetePecheSel$'Autres types de peche'))/length(enquetePecheSel$'Autres types de peche'))*100,2)`%

```{r autre_peche, fig.cap="Nombre de pêcheurs pratiquant une autre pratique de pêche"}
autrepeche.count <- enquetePecheSel %>% separate_rows(`Autres types de peche`,sep="\\|") 

autrepeche.count$`Autres types de peche` <- str_trim(autrepeche.count$`Autres types de peche`,side=c("both"))

autrepeche.count <- autrepeche.count %>%   count(`Autres types de peche`)

autrepeche.count <- drop_na(autrepeche.count)

knitr::kable(autrepeche.count, caption = "Autres types de pêche effectués par les pécheurs à pied")
```

  
####	Autres sites fréquentés
  
Rapports : [2] ; [3]  
Les données sont bancarisées dans le jeu de données « enquête_pratiques_peche », dans la variable « Autres Sites Fréquentés », la variable « Départements » et la variable « Noms sites ».  
Etat des données :  

* Départements  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$Départements))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$Départements))/length(enquetePecheSel$Départements))*100,2)`%
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.
* Autres sites fréquentés   
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Autre Sites fréquentés'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Autre Sites fréquentés'))/length(enquetePecheSel$'Autre Sites fréquentés'))*100,2)`%
* Noms sites :  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Nom sites'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Nom sites'))/length(enquetePecheSel$'Nom sites'))*100,2)`%
  + Commentaires : grande diversité de format d’écriture pour les noms de sites (sigle, en toutes lettres…) et une grande diversité de séparation de modalité au sein d’une observation. 
  
```{r Autres_sites, include=FALSE}

autres_sites.count <- enquetePecheSel %>% count(`Nom sites`)
knitr::kable(autres_sites.count, caption = "Nom de sites d'autres sités fréquentés")
```
  
```{r departements}
depart.count <- enquetePecheSel %>% separate_rows(`Départements`,sep="\\|") 

depart.count$`Départements`<- str_trim(depart.count$`Départements`,side=c("both"))

depart.count <- depart.count %>%   count(`Départements`) %>% mutate(`Départements`=iconv(`Départements`,"UTF-8",to="latin1", sub="byte"))

depart.count <- drop_na(depart.count)

knitr::kable(depart.count, caption = "Départements d'origine des pêcheurs")
```  




####	Critères de choix de la marée
  
Rapports : [2] ; [3] ; [5]  
Les rapports n’utilisent pas tous la même analyse, certains rapports se concentre sur le coefficient de marée, quant à d’autres se basent plus sur les réponses du questionnaire   
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Coefficient Maree Mini » ou dans la variable « Choix des marées ».  

Etat des données :

* Coefficient Maree Mini  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Coefficient Maree Mini'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Coefficient Maree Mini'))/length(enquetePecheSel$'Coefficient Maree Mini'))*100,2)`%
  + Moyenne : `r round(mean(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE),2)`
  + Minimum : `r min(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE)`
  + Maximum : `r max(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE)`
* Choix des marées   
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Choix des marées'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Choix des marées'))/length(enquetePecheSel$'Choix des marées'))*100,2)`% 
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par "|".  

```{r criteres_choix_marée, fig.cap="Nombre de pêcheurs selon le coefficient minimum pour aller pêcher"}

coefmini.count <- enquetePecheSel %>% count(`Coefficient Maree Mini`) %>% rename( coefminimum = `Coefficient Maree Mini`)
coefmini.count <- coefmini.count %>% mutate(coef_mini =cut(coefminimum,breaks = seq(0, 120, 10), right = FALSE))

coefmini.count <- drop_na(coefmini.count)
ggplot(coefmini.count, aes(x = `coef_mini`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
```


```{r choix_marees, fig.cap="Nombre de pêcheurs selon les critères de choix de marée"}

choixmarees.count <- enquetePecheSel %>% separate_rows(`Choix des marées`, sep = '\\|')

choixmarees.count$`Choix des marées` <- str_trim(choixmarees.count$`Choix des marées`,side=c("both"))


choixmarees.count <- choixmarees.count %>% count(`Choix des marées`)
choixmarees.count <-  drop_na(choixmarees.count)

knitr::kable(choixmarees.count, caption = 'Liste des divers choix de marées' )
```


#### Critère de choix de site
  
Rapports : [2] ; [3]  
Les données sont bancarisées dans le jeu de données « enquête_preparation_peche », dans la variable « Critères choix site ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Critéres choix site'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Critéres choix site'))/length(enquetePecheSel$'Critéres choix site'))*100,2)`%
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  

```{r critères_choix_site}

critchoixsite.count <-enquetePecheSel %>% separate_rows(`Critéres choix site`, sep = '\\|')

critchoixsite.count$`Critéres choix site` <- str_trim(critchoixsite.count$`Critéres choix site`, side = c("both"))

critchoixsite.count <- critchoixsite.count %>% count(`Critéres choix site`) %>%  mutate(`Critéres choix site`=iconv(`Critéres choix site`,"UTF-8",to="latin1", sub="byte"))

critchoixsite.count <- drop_na(critchoixsite.count)

knitr::kable(critchoixsite.count, caption = "Liste des critères pour choisir un site")
```




####	Fréquence de pratique de pêche
  
Rapports : [2] ; [3]  
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Frequence Declaree Peche ».  
Plusieurs variables « fréquence » existent dans les différents jeux de données de la Base ESTAMP, « Frequence Declaree Peche » semble correspondre le plus à cet élément.  
Etat des données :  

* Frequence de la pratique de la pêche
  - Nombre d’observations : `r length(na.omit(enquetePecheSel$'Frequence Declaree Peche'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Frequence Declaree Peche'))/length(enquetePecheSel$'Frequence Declaree Peche'))*100,2)`%
  - Moyenne : `r round(mean(enquetePecheSel$'Frequence Declaree Peche', na.rm=TRUE),2)`
  - Minimum : `r min(enquetePecheSel$'Frequence Declaree Peche', na.rm=TRUE)`
  - Maximum : `r max(enquetePecheSel$'Frequence Declaree Peche', na.rm=TRUE)`
* Peche chaque annee
  - Nombre d'observations : `r length(na.omit(enquetePecheSel$'Peche Chaque Annee'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Peche Chaque Annee'))/length(enquetePecheSel$'Peche Chaque Annee'))*100,2)`%
* Premiere pêche
  - Nombre d'observations : `r length(na.omit(enquetePecheSel$'Premiere Peche'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Premiere Peche'))/length(enquetePecheSel$'Premiere Peche'))*100,2)`%
* Nombre pêche an
  - Nombre d'observations : `r length(na.omit(enquetePecheSel$'Nb Peches Annuelles'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Nb Peches Annuelles'))/length(enquetePecheSel$'Nb Peches Annuelles'))*100,2)`%
  - Moyenne : `r round(mean(enquetePecheSel$'Nb Peches Annuelles', na.rm=TRUE),2)`
  - Minimum : `r min(enquetePecheSel$'Nb Peches Annuelles', na.rm=TRUE)`
  - Maximum : `r max(enquetePecheSel$'Nb Peches Annuelles', na.rm=TRUE)`
  

```{r frequence_pratique, fig.cap="Fréquence de la pratique de la pêche"}

freqprat.count <- enquetePecheSel %>% count(`Frequence Declaree Peche`)
freqprat.count <- drop_na(freqprat.count)
ggplot(freqprat.count, aes(x = `Frequence Declaree Peche`, y= n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  xlab("Fréquence de la pratique de la pêche")+
  obade_theme
```


```{r peche_chaque_annee}

pecheannee.count <- enquetePecheSel %>% count(`Peche Chaque Annee`)
pecheannee.count <- drop_na(pecheannee.count)

ggplot(pecheannee.count, aes(x= `Peche Chaque Annee`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme
```


```{r premiere_peche}

premierepeche.count <- enquetePecheSel %>% count(`Premiere Peche`)
premierepeche.count <- drop_na(premierepeche.count)

ggplot(premierepeche.count, aes(x= `Premiere Peche`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme
```

```{r nombre_pêche_an}

ggplot(enquetePecheSel, aes(x = `Nb Peches Annuelles`))+
  geom_histogram(breaks=seq(0,max(na.omit(enquetePecheSel$`Nb Peches Annuelles`)),5))+  
  scale_x_continuous(breaks=seq(0,max(na.omit(enquetePecheSel$`Nb Peches Annuelles`)),20))+
  ylab("Nombre d'observation")+ xlab("Nombre de pêches par an")+
  obade_theme
```


####	Coefficient minimum de pêche
  
Rapports : [2] ; [5] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Coefficient marée Mini ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Coefficient Maree Mini'))`
* Taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'Coefficient Maree Mini'))/length(enquetePecheSel$'Coefficient Maree Mini'))*100,2)`%
* Moyenne : `r round(mean(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE),2)`
* Minimum : `r min(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE)`
* Maximum : `r max(enquetePecheSel$'Coefficient Maree Mini', na.rm=TRUE)`
  
```{r criteres_choix_maree2, fig.cap="Nombre de pêcheurs selon le coefficient minimum pour aller pêcher"}

coefmini.count <- enquetePecheSel %>% count(`Coefficient Maree Mini`) %>% rename( coefminimum = `Coefficient Maree Mini`)
coefmini.count <- coefmini.count %>% mutate(coef_mini =cut(coefminimum,breaks = seq(0, 120, 10), right = FALSE))

coefmini.count <- drop_na(coefmini.count)
ggplot(coefmini.count, aes(x = `coef_mini`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  xlab("Coefficient minimun pour aller pêcher")+
  obade_theme
```

####	Période de fréquentation du site
  
Rapports : [2] ; [3] ; [5] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête_pratique_peche », dans la variable « Mois de peche ».
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Mois de peche'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Mois de peche'))/length(enquetePecheSel$'Mois de peche'))*100,2)`% 
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  
  
```{r periode_frequentation, fig.cap="Période de fréquentation du site"}

freqperiode.count <- enquetePecheSel %>% separate_rows(`Mois de peche`, sep = '\\|')

freqperiode.count$`Mois de peche` <- str_trim(freqperiode.count$`Mois de peche`,side=c("both"))


freqperiode.count <- freqperiode.count %>% count(`Mois de peche`)
freqperiode.count <-  drop_na(freqperiode.count)

knitr::kable(freqperiode.count, caption = 'Liste des mois de pêche avec leurs affluences' )
```
  
```{r periode_graphique}

ggplot(freqperiode.count, aes(x= `Mois de peche`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme

```


###	 Connaissance du pêcheur
  
####	Renseignement et source d’information sur l’heure de la marée
  
Rapports : [1] ; [3] ; [4] ; [5] ; [6]  
L’origine des données n’est qu’une supposition :  
  Les données sont possiblement bancarisées dans le jeu de données « enquête_preparation_peche », dans la variable « Source d’information ».  
Etat des données : 
  
* Annuaire de marée 
* Nombre d’observations : `r length(na.omit(enquetePecheSel$"Annuaire de marée"))` 
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$"Annuaire de marée"))/length(enquetePecheSel$"Annuaire de marée"))*100,2)`%
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  
  
```{r annuaire_maree}

annuairemaree.count <- enquetePecheSel %>% count(`Annuaire de marée`)
annuairemaree.count <- drop_na(`annuairemaree.count`)

ggplot(annuairemaree.count, aes(x=`Annuaire de marée`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  xlab("Connaissance de l'horaire de marée")+
  obade_theme
```
  
  
  
```{r source_informations_maree, fig.cap="Sources d'information utilisées par les pêcheurs pour connaitre l'horaire de marée"}

sourceinfomaree.count <- enquetePecheSel %>% separate_rows(`Source d'information`, sep = '\\|')

sourceinfomaree.count$`Source d'information` <- str_trim(sourceinfomaree.count$`Source d'information`,side=c("both"))


sourceinfomaree.count <- sourceinfomaree.count %>% count(`Source d'information`) %>%  mutate(`Source d'information`=iconv(`Source d'information`,"UTF-8",to="latin1", sub="byte"))

sourceinfomaree.count <-  drop_na(sourceinfomaree.count)

knitr::kable(sourceinfomaree.count, caption = 'Liste des sources d informations utilisées par les pêcheurs pour connaitre les horaires de marées' )


```
  
  
  
  
####	Renseignement et source d’information sur l’aspect sanitaires du site

Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Les renseignements utilisent deux variables.  
Les données sont bancarisées dans le jeu de données « enquête_preparation_peche », dans la variable « Etat Sanitaire » et dans la variable « Source d’information ».

Etat des données :

* Etat Sanitaire :  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Etat Sanitaire'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Etat Sanitaire'))/length(enquetePecheSel$'Etat Sanitaire'))*100,2)`% 
* Source d’information  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$"Source d'information"))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$"Source d'information"))/length(enquetePecheSel$"Source d'information"))*100,2)`% 
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.  
  
```{r etat_sanitaire, fig.cap="Graphique illustrant la connaissance ou non de l'état sanitaire"}

etatsanit.count <- enquetePecheSel %>% count(`Etat Sanitaire`)
ggplot(etatsanit.count, aes(x = `Etat Sanitaire`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de Pêcheurs")+
  obade_theme
```
  
```{r source_information_sanitaire, fig.cap="SOurces d'information utilisées par les pêcheurs pour connaitre l'état sanitaire du site de pêche"}

infosanit.count <- enquetePecheSel %>% separate_rows(`Source d'information`, sep= '\\|')

infosanit.count$`Source d'information` <- str_trim(infosanit.count$`Source d'information`, side=c("both"))

infosanit.count <- infosanit.count %>% count(`Source d'information`) %>%  mutate(`Source d'information`=iconv(`Source d'information`,"UTF-8",to="latin1", sub="byte"))

infosanit.count <- drop_na(infosanit.count)

knitr::kable(infosanit.count, caption = "Liste des sources d'informations utilisées par les pêcheurs pour connaitre l'état sanitaire du site")
```
  


####	Connaissance et source d’information de la réglementation
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Plusieurs variables de la base ESTAMP sont utilisées pour cet analyse.  
Les données sont bancarisées dans le jeu de données « enquete_connaissance_peche », dans les variables : 

* « Connaissance réglementation »
* « Connaissance quotas »
* « Connaissance Période »
* « Source d’information »
* « Informé Législation »
* « Déclaration connaissance »
* « Périodes déclarées »
* « Connaissance réglementation période »
* « Source d’information législation »

Etat des données :  

* Connaissance réglementation  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'connaissance réglementation'))`
  + Taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'connaissance réglementation'))/length(enquetePecheSel$'connaissance réglementation'))*100,2)`%
* Connaissance quotas
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Connaissance quota'))`
  + Taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'Connaissance quota'))/length(enquetePecheSel$'Connaissance quota'))*100,2)`%
* Connaissance période
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Connaissance Période'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Connaissance Période'))/length(enquetePecheSel$'Connaissance Période'))*100,2)`%
* Source d’information
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Source information législation'))`
  + Taux de remplissage :`r round((length(na.omit(enquetePecheSel$'Source information législation'))/length(enquetePecheSel$'Source information législation'))*100,2)`%
  + Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.
* Informé Législation
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Informé Législation'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Informé Législation'))/length(enquetePecheSel$'Informé Législation'))*100,2)`%
* Périodes déclarées
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Périodes Déclarées'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Périodes Déclarées'))/length(enquetePecheSel$'Périodes Déclarées'))*100,2)`%
* Connaissance réglementation période
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Connaissance Règlementation Période'))`
  + Taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'Connaissance Règlementation Période'))/length(enquetePecheSel$'Connaissance Règlementation Période'))*100,2)`%
* Source information législation  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$"Source information législation"))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Source information législation'))/length(enquetePecheSel$'Source information législation'))*100,2)`%
  
```{r conn_reglementation, fig.cap="Graphique indiquant la connaissance des pêcheurs sur la période pêche"}

connregl.count <- enquetePecheSel %>% count(`connaissance réglementation`)
connregl.count <- drop_na(connregl.count)
ggplot(connregl.count, aes(x = `connaissance réglementation`, y= n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
```
  
```{r conn_quotas, fig.cap="Graphique la connaissance des pêcheurs sur les quotas de pêche"}

connquotas.count <- enquetePecheSel %>% count(`Connaissance quota`)
connquotas.count <- drop_na(connquotas.count)
ggplot(connquotas.count, aes(x = `Connaissance quota`, y= n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme
```

```{r conn_periode, fig.cap="Graphique la connaissance des pêcheurs sur les quotas de pêche"}

connperiode.count <- enquetePecheSel %>% count(`Connaissance Période`)
connperiode.count <- drop_na(connperiode.count)
ggplot(connperiode.count, aes(x = `Connaissance Période`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme
```

```{r source_information_legislation, fig.cap="Sources d'information utilisées par les pêcheurs pour connaitre la législation"}

infolegis.count <- enquetePecheSel %>% separate_rows(`Source information législation`, sep= '\\|')

infolegis.count$`Source information législation` <- str_trim(infolegis.count$`Source information législation`, side=c("both"))

infolegis.count <- infolegis.count %>% count(`Source information législation`) %>%  mutate(`Source information législation`=iconv(`Source information législation`,"UTF-8",to="latin1", sub="byte"))

infolegis.count <- drop_na(infolegis.count)

knitr::kable(infosanit.count, caption = "Liste des sources d'informations utilisées par les pêcheurs pour connaitre l'état sanitaire du site")

```

```{r inf_legislation, fig.cap="Graphiques indiquant l'état d'information sur la législation par les pêcheurs"}


inflegis.count <- enquetePecheSel %>% count(`Informé Législation`)
inflegis.count <- drop_na(inflegis.count)
ggplot(inflegis.count, aes(x = `Informé Législation`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme
```

```{r conn_periode_reglementation, fig.cap="Graphiques indiquant l'état de connaissance sur la réglementation de période pour la pêche à pied"}

connperregl.count <- enquetePecheSel %>% count(`Connaissance Règlementation Période`)
connperregl.count <- drop_na(connperregl.count)
ggplot(connperregl.count, aes(x = `Connaissance Règlementation Période`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))
```



####	Adhésion à une association
  
Rapports : [1] ; [3]  
Les données sont bancarisées dans le jeu de données « enquete_connaissance_pecheur », dans la variable « Membre Association ».  
Etat des données :   

* Membre association :
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$"Membre Association"))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Membre Association'))/length(enquetePecheSel$'Membre Association'))*100,2)`%
* Nom Association :
  + Nombre d'observations : `r length(na.omit(enquetePecheSel$"Nom Association"))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$"Nom Association"))/length(enquetePecheSel$"Nom Association"))*100,2)`%
  
```{r association, fig.align= 'center', fig.cap="Nombre de pêcheurs adhérent à une association"}

assoc.count <- enquetePecheSel %>% count(`Membre Association`)
assoc.count <- drop_na(assoc.count)
ggplot(assoc.count, aes(x = `Membre Association`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme
```

```{r nom_association, fig.cap="Liste des noms d'associations citées"}

nomassoc.count <- enquetePecheSel %>% count(`Nom Association`)
nomassoc.count <- drop_na(nomassoc.count)
knitr::kable(nomassoc.count, caption = "Liste des association citées")

```

  
####	Pratique du dégorgement
 
Rapports : [1] ; [2]  
Les données sont bancarisées dans le jeu de données « enquete_connaissance_pecheur », dans la variable « Conseils consommation ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Conseils consommation'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Conseils consommation'))/length(enquetePecheSel$'Conseils consommation'))*100,2)`%

  
```{r degorgement}


degor.count <- enquetePecheSel %>% count(`Conseils consommation`)

degor.count <- drop_na(degor.count)

ggplot(degor.count, aes(x = `Conseils consommation`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  xlab("Pratique du dégorgement")+
  obade_theme

```
  
  
####	Utilisation d’un outil de mesure
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5]  
Plusieurs variables de la base ESTAMP sont utilisées pour cet analyse.  
Les données sont bancarisées dans le jeu de données « enquete_connaissance_pecheur », dans la variable « Utilisation outil » et dans la variable « Source outil ».  
Etat des données :

* Utilisation outil  
  + Nombre d’observations :`r length(na.omit(enquetePecheSel$'Utilisation outil'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Utilisation outil'))/length(enquetePecheSel$'Utilisation outil'))*100,2)`%
* Source outil  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Source outil'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Source outil'))/length(enquetePecheSel$'Source outil'))*100,2)`%
* Outil conforme
  - Nombre d'observations :`r length(na.omit(enquetePecheSel$'Outil Conforme'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Outil Conforme'))/length(enquetePecheSel$'Outil Conforme'))*100,2)`%
  
```{r outil_mesure, fig.cap="Nombre de pêcheur utilisant un outil de mesure"}

outil.count <- enquetePecheSel %>% count(`Utilisation outil`)
outil.count <- drop_na(outil.count)
ggplot(outil.count, aes(x = `Utilisation outil`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme
```

```{r source_outil, fig.cap="Liste des outils utilisées"}

sourceoutil.count <- enquetePecheSel %>% count(`Source outil`) %>%  mutate(`Source outil`=iconv(`Source outil`,"UTF-8",to="latin1", sub="byte"))
sourceoutil.count <- drop_na(sourceoutil.count)
knitr::kable(sourceoutil.count, caption = "Liste des outils de mesure utilisés")
```

```{r outil_conforme}

outilconf.count <- enquetePecheSel %>% count(`Outil Conforme`)
outilconf.count <- drop_na(outilconf.count)

ggplot(outilconf.count, aes(x = `Outil Conforme`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme
```


####	Source d’information
  
Rapports : [2] ; [4] ; [5]  
Les données sont bancarisées dans le jeu de données « enquête_connaissance_pecheur », dans la variable « Source d’information législation ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Source information législation'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Source information législation'))/length(enquetePecheSel$'Source information législation'))*100,2)`%

```{r source_information_legislation2, fig.cap="Sources d'information utilisées par les pêcheurs pour connaitre la législation"}

infolegis.count <- enquetePecheSel %>% separate_rows(`Source information législation`, sep= '\\|')

infolegis.count$`Source information législation` <- str_trim(infolegis.count$`Source information législation`, side=c("both"))

infolegis.count <- infolegis.count %>% count(`Source information législation`) %>%  mutate(`Source information législation`=iconv(`Source information législation`,"UTF-8",to="latin1", sub="byte"))

infolegis.count <- drop_na(infolegis.count)

knitr::kable(infosanit.count, caption = "Liste des sources d'informations utilisées par les pêcheurs pour connaitre l'état sanitaire du site")

```

###	Analyse des paniers/pêche du jour
 
####	Constitution du panier
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête_peche_jour », dans la variable « poids recolte », dans la variable « Espece », dans la variable « Nb individus », dans la variable « Panier vide » et dans « Poids maille ».  
Etat des données : 

* Espèce  
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Espece'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Espece'))/length(enquetePecheSel$'Espece'))*100,2)`%
* Nb individus
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Nb individus'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Nb individus'))/length(enquetePecheSel$'Nb individus'))*100,2)`%
  + Moyenne : `r round(mean(enquetePecheSel$'Nb individus', na.rm=TRUE),2)`
  + Minimum : `r min(enquetePecheSel$'Nb individus', na.rm=TRUE)`
  + Maximum : `r max(enquetePecheSel$'Nb individus', na.rm=TRUE)`
* Poids récolte
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Poids récolte'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Poids récolte'))/length(enquetePecheSel$'Poids récolte'))*100,2)`%
  + Moyenne : `r round(mean(enquetePecheSel$'Poids récolte', na.rm=TRUE),2)`
  + Minimun : `r min(enquetePecheSel$'Poids récolte', na.rm=TRUE)`
  + Maximun : `r max(enquetePecheSel$'Poids récolte', na.rm=TRUE)`
  + Commentaires : Données anormales soit trop importantes, soit petites
* Panier vide
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Panier vide'))`
  + Taux d’observations : `r round((length(na.omit(enquetePecheSel$'Panier vide'))/length(enquetePecheSel$'Panier vide'))*100,2)`%

```{r espece_panier, fig.cap="Liste des espèces pêchées par les pêcheurs"}

especepanier.count <- enquetePecheSel %>% count(`Espece`)
especepanier.count <- drop_na(especepanier.count)

knitr::kable(especepanier.count, caption = "Liste des espèces pêchées par les pêcheurs")

```

```{r nb_individus, fig.cap="Nombre de d'individus pêchés par pêcheurs"}

individu.count <- enquetePecheSel %>% count(`Nb individus`)
individu.count <- drop_na(individu.count)
ggplot(individu.count, aes(x = `Nb individus`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```

```{r poids_recolte, fig.cap="Poids de récolte par pêcheur"}

poidsrecolte.count <- enquetePecheSel %>% count(`Poids récolte`)
poidsrecolte.count <- drop_na(poidsrecolte.count)
ggplot(poidsrecolte.count, aes(x = `Poids récolte`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```

```{r panier_vide, fig.cap="Nombre panier vide"}

paniervide.count <- enquetePecheSel %>% count(`Panier vide`)
paniervide.count <- drop_na(paniervide.count)

ggplot(paniervide.count, aes(x = `Panier vide`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```


####	Analyse de la conformité
  
Rapports : [1] ; [3] ; [4] ; [5]  
Cette sous partie n’est pas toujours remplie ou alors mixée avec la partie précédente. Elle représente souvent qu’une seule phrase avec un pourcentage de conformité. Les données pouvant répondre à ces analyses sont possiblement bancarisées dans le jeu de données « enquête_peche_jour », dans la variable « Conformité maille » et/ou dans la variable « Conformité quantité ».  
Etat des données :  

* Conformité maille   
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Conformité maille'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Conformité maille'))/length(enquetePecheSel$'Conformité maille'))*100,2)`%
* Conformité quantité
  + Nombre d’observations : `r length(na.omit(enquetePecheSel$'Conformité quantité'))`
  + Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Conformité quantité'))/length(enquetePecheSel$'Conformité quantité'))*100,2)`%

```{r conformite_maille, fig.cap="Nombre de pêcheurs ayant un panier conforme pour la maille"}

confomaille.count <- enquetePecheSel %>% count(`Conformité maille`)
confomaille.count <- drop_na(confomaille.count)

ggplot(confomaille.count, aes(x = `Conformité maille`, y = n ))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```

```{r conformite_quantite, fig.cap="Nombre de pêcheurs ayant un panier conforme pour la quantité"}

confoquant.count <- enquetePecheSel %>% count(`Conformité quantité`)
confoquant.count <- drop_na(confoquant.count)

ggplot(confoquant.count, aes(x = `Conformité quantité`, y = n ))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```

####	Temps de pêche moyen
  
Rapports : [1] ; [2] ; [3] ; [4] ; [5] ; [6]  
Les données sont bancarisées dans le jeu de données « enquête_peche_jour », dans la variable « Temps total Peche ».  
Etat des données :

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Temps total Peche'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Temps total Peche'))/length(enquetePecheSel$'Temps total Peche'))*100,2)`%
* Moyenne : `r round(mean(enquetePecheSel$'Temps total Peche', na.rm=TRUE), 2)`
* Minimum : `r min(enquetePecheSel$'Temps total Peche', na.rm=TRUE)`
* Maximum : `r max(enquetePecheSel$'Temps total Peche', na.rm=TRUE)`


```{r temps_peche, fig.cap="Temps de pêche moyen"}

ggplot(enquetePecheSel, aes(x = `Temps total Peche`))+
  geom_histogram(breaks=seq(0,max(na.omit(enquetePecheSel$`Temps total Peche`)),20))+  
  scale_x_continuous(breaks=seq(0,max(na.omit(enquetePecheSel$`Temps total Peche`)),40))+
  ylab("Nombre d'observation")+ xlab("Temps total de pêche (min)")+
  obade_theme
```


####	Estimation des prélèvements
  
Il y a peu de rapports qui ont rempli cette partie, leur démarche n’est pas expliquée. Il est donc difficile si des données de la base de données ESTAMP sont utilisés et si oui, lesquelles.  
  
####	Périodes privilégiées de pêche
  
Peu de rapports développent cette partie. Cependant un rapport semble utiliser les données dans le jeu « enquête_pratique_peche », dans la variable « Choix des marées ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Choix des marées'))`
* Taux de remplissage :`r round((length(na.omit(enquetePecheSel$'Choix des marées'))/length(enquetePecheSel$'Choix des marées'))*100,2)`%
* Commentaires : plusieurs modalités dans une observation. Elles sont séparées par |.
  
``` {r periode_privilégées, fig.height=10,fig.width=5}

periodepriv.count <- enquetePecheSel %>% separate_rows(`Choix des marées`, sep = '\\|')

periodepriv.count$`Choix des marées` <- str_trim(periodepriv.count$`Choix des marées`, side=c("both"))

periodepriv.count <- periodepriv.count %>% count(`Choix des marées`)

periodepriv.count <- drop_na(periodepriv.count)

ggplot(periodepriv.count, aes(x= `Choix des marées`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre d'observations")+
  obade_theme+
  theme(axis.text.x = element_text(angle=90,hjust=1))

```
  
  
####	Qualité de la récolte
  
Les rapports n’ont pas développé cette partie.  
  
###	Attitudes des pécheurs à pied face aux enquêteurs
  
####	Réceptivité des pécheurs face aux conseils promulgués
  
Rapports : [1] ; [3] ; [4] ; [5]  
Les données sont bancarisées dans le jeu « enquête_detail », dans la variable « Sensibilisation ».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Sensibilisation'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Sensibilisation'))/length(enquetePecheSel$'Sensibilisation'))*100,2)`%
   
```{r reception_conseils, fig.cap="Reception des pêcheurs face aux conseils promulgués"}

recpcons.count <- enquetePecheSel %>% count(`Sensibilisation`)
recpcons.count <- drop_na(recpcons.count)

ggplot(recpcons.count, aes(x = `Sensibilisation`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme

```
   
#### Tri des récoltes
  
Rapports : [1] ; [3] ; [4] ; [5]  
Les données sont bancarisées dans le jeu « enquête_preparation_peche », dans la variable «Tri du panier».  
Etat des données :  

* Nombre d’observations : `r length(na.omit(enquetePecheSel$'Tri du panier'))`
* Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Tri du panier'))/length(enquetePecheSel$'Tri du panier'))*100,2)`%

```{r tri_recolte, fig.cap="Tri des récoltes"}

trirecolte.count <- enquetePecheSel %>% count(`Tri du panier`)
trirecolte.count <- drop_na(trirecolte.count)


ggplot(trirecolte.count, aes(x = `Tri du panier`, y = n))+
  geom_bar(stat = "identity")+
  ylab("Nombre de pêcheurs")+
  obade_theme 
```

#### Réglettes et flyers distribués

Les données sont bancarisées dans le jeu « enquête_preparation_peche », dans la variable «Nb Reglettes» et dans la variable  «Nb Depliants».
Etat des données :  

* Nb Reglettes
  - Nombre d'observations : `r length(na.omit(enquetePecheSel$'Nb Reglettes'))`
  - Taux de remplissage : `r round((length(na.omit(enquetePecheSel$'Nb Reglettes'))/length(enquetePecheSel$'Nb Reglettes'))*100,2)`%
  - Moyenne : `r round(mean(enquetePecheSel$'Nb Reglettes', na.rm = TRUE), 2)`
  - Minimum : `r min(enquetePecheSel$'Nb Reglettes', na.rm=TRUE)`
  - Maximum : `r max(enquetePecheSel$'Nb Reglettes', na.rm=TRUE)`
* Nb Depliants
  - Nombre d'observations :`r length(na.omit(enquetePecheSel$'Nb Depliants'))`
  - taux de remplissage :  `r round((length(na.omit(enquetePecheSel$'Nb Depliants'))/length(enquetePecheSel$'Nb Depliants'))*100,2)`%
  - Moyenne : `r round(mean(enquetePecheSel$'Nb Depliants', na.rm = TRUE), 2)`
  - Minimum : `r min(enquetePecheSel$'Nb Depliants', na.rm=TRUE)`
  - Maximum : `r max(enquetePecheSel$'Nb Depliants', na.rm=TRUE)`
  
```{r reglettes}

reglette.count <- enquetePecheSel %>% count(`Nb Reglettes`)
reglette.count <- drop_na(reglette.count)

ggplot(enquetePecheSel, aes(x = `Nb Reglettes`))+
  geom_histogram()+
  ylab("Nombre d'observations")+
  obade_theme
```

```{r flyers}

ggplot(enquetePecheSel, aes(x = `Nb Depliants`))+
  geom_histogram()+
  ylab("Nombre d'observations")+
  obade_theme

```


##	Conclusion

  
Bibliographie :  
[1] Rapport de diagnostic de la pêche de loisir sur le territoire de Guissény   
[2] Bilan des actions sur le territoire du Pays de Morlaix   
[3] Rapport de diagnostic de la pêche à pied de loisir sur le territoire Côtes d’Armor lot numero 5 2018  
[4] Rapport de diagnostic de la pêche à pied de loisir dans l’Ouest des Côtes d’Armor   
[5] Rapport de diagnostic de la pêche à pied de loisir sur les territoires de la Rance et de la Côte d’Emeraude 2018  
[6] Etat des lieux de la pêche à pied de loisir / Bilan d’actions 2015-2017 / CPIE LOIRE OCEANE  


## Annexes 
  
```{r commune, fig.cap= "Liste des communes citées"}

commune.count <- enquetePecheSel %>% count(`Commune résidence`)
knitr::kable(commune.count, caption = "Liste des communes citées")

```

 \pagebreak  
 
```{r noms_sites, fig.cap="Noms de site de pêche à pied cités par les pêcheurs"}

noms_sites.count <- enquetePecheSel %>% count(`Nom sites`) %>% mutate(`Nom sites` =iconv(`Nom sites`,"UTF-8",to="latin1", sub="byte"))

noms_sites.count <- drop_na(noms_sites.count)


knitr::kable(noms_sites.count, caption = "Noms de sites de pêche à pied cités par les pêcheurs ")

```

\pagebreak