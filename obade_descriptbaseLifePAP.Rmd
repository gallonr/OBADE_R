---
title: "Description des données *d'usage* de la base ESTAMP"
subtitle: "LifePAP"

output:
  html_document:
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: false
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
require(tidyverse)
require(plotly)
library(bookdown)
```

```{r load_data,include=FALSE}

source("internal_function.R")
load("./export/table/enquetePeche.Rdata")
enquetePeche.resum <- descript.database(enquetePeche)
enquetePeche.resum <- enquetePeche.resum %>% mutate(pourc_NA=(Nombre_NA/nrow(enquetePeche))*100)

selection_version_protocole <- c("LifePAP")


ifelse(length(selection_version_protocole)>0, 
       enquetePecheLifePAP <- enquetePeche %>% filter(`version protocole` %in% selection_version_protocole),
       enquetePecheLifePAP <- enquetePeche)


```


**Contexte**

La réalisation des données d'usage nécessite au préalable de décrire les données présentes dans la base ESTAMP. Cette description permettra de mettre en avant les points forts et les points faibles permettant ainsi d'élaborer d'éventuelles solutions pour améliorer la robustesse[^2] de la base.

Les données ont été extraites le `r format(Sys.Date(), "%d-%m-%Y")` via le site web (https://estamp.afbiodiversite.fr/).

L'extraction est composée de  `r length(list.files("./data/enquete/"))` fichiers :
```{r listdataenquete, comment=NA}

cat(str_c(list.files("./data/enquete/"),collapse=" \n"))


```


### **1 Description des données extraites**


Le jeu de données est composé de `r dim(enquetePecheLifePAP)[1]` lignes (= observations) et `r dim(enquetePecheLifePAP)[2]` colonnes (= variables)

```{r pratPeche.resum, message=FALSE, warning=FALSE}
enquetePecheLifePAP.resum <- descript.database(enquetePecheLifePAP)
enquetePecheLifePAP.resum <- enquetePecheLifePAP.resum %>% mutate(pourc_NA=(Nombre_NA/nrow(pratPeche))*100)
enquetePecheLifePAP.resum %>% select(-pourc_NA)
```

```{r pratPeche.na, echo=FALSE, fig.height=7, fig.width=10}
ggplot(enquetePecheLifePAP.resum,aes(x =reorder(Variable,-pourc_NA),y=pourc_NA))+
  geom_bar(stat="identity") + ylab("% de données non renseignées") + xlab("")+
  theme_bw()+  obade_theme+
  theme(axis.text.x = element_text(angle=90,vjust=0.5,hjust=1))
```


